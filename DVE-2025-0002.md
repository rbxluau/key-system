# DVE-2025-0002
Tags: <kbd>flash</kbd> <kbd>hookfunction</kbd> <kbd>string.gsub</kbd>
> [!CAUTION]
> Severity: <kbd>High</kbd>
## Description
The hex_to_binary method in the Ditto Key System Flash uses string.gsub, which can be exploited by hooking string.gsub, resulting in an SDK info leak.
## Example
### hex_to_binary
```lua
local hex_to_binary = function(hex_str)
    local raw =
        (hex_str:gsub(
        "..",
        function(hex)
            return string.char(tonumber(hex, 16))
        end
    ))
    return raw
end
```
### hook string.gsub
```lua
GsubCall = hookfunction(string.gsub, function(self, patt, ...)
    if patt == ".." and self:match("^%x+$") then
        print(self)
    end
    return GsubCall(self, patt, ...)
end)

```
