# DVE-2025-0001
Tags: <kbd>pro</kbd> <kbd>hookfunction</kbd> <kbd>string.sub</kbd>
> [!CAUTION]
> Severity: <kbd>High</kbd>
## Description
The hex_to_binary method in the Ditto Key System Pro uses string.sub, which can be exploited by hooking string.sub, resulting in an SDK info leak.
## Example
### hex_to_binary
```lua
local hex_to_binary =
    function(hex_str)
        local n = #hex_str
        if n % 2 ~= 0 then
            return nil
        end
        local t = {}
        for i = 1, n, 2 do
            local byte = tonumber(hex_str:sub(i, i + 1), 16)
            if not byte then
                return nil
            end
            t[#t + 1] = string.char(byte)
        end
        return table_concat(t)
    end
```
### hook string.sub
```lua
SubCall = hookfunction(string.sub, function(self, ...)
    if self:match("^%x+$") then
        print(self)
    end
    return SubCall(self, ...)
end)

```

